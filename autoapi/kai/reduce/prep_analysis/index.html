<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>kai.reduce.prep_analysis &mdash; KAI  documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="kai.reduce.reduce_template" href="../reduce_template/index.html" />
    <link rel="prev" title="kai.reduce.lin_correction" href="../lin_correction/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            KAI
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">kai</span></code></a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../../index.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../extern/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">kai.extern</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../mtf/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">kai.mtf</span></code></a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">kai.reduce</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tests/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">kai.tests</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">kai.utils</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../index.html#submodules">Submodules</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../test_drizzle/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">test_drizzle</span></code></a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">KAI</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">API Reference</a></li>
          <li class="breadcrumb-item"><a href="../../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">kai</span></code></a></li>
          <li class="breadcrumb-item"><a href="../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">kai.reduce</span></code></a></li>
      <li class="breadcrumb-item active"><code class="xref py py-mod docutils literal notranslate"><span class="pre">kai.reduce.prep_analysis</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/autoapi/kai/reduce/prep_analysis/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-kai.reduce.prep_analysis">
<span id="kai-reduce-prep-analysis"></span><h1><a class="reference internal" href="#module-kai.reduce.prep_analysis" title="kai.reduce.prep_analysis"><code class="xref py py-mod docutils literal notranslate"><span class="pre">kai.reduce.prep_analysis</span></code></a><a class="headerlink" href="#module-kai.reduce.prep_analysis" title="Link to this heading"></a></h1>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading"></a></h2>
<section id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Link to this heading"></a></h3>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#kai.reduce.prep_analysis.euclidean" title="kai.reduce.prep_analysis.euclidean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">euclidean</span></code></a>(x1, y1, x2, y2)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#kai.reduce.prep_analysis.removeEdges" title="kai.reduce.prep_analysis.removeEdges"><code class="xref py py-obj docutils literal notranslate"><span class="pre">removeEdges</span></code></a>(imgArr, finalTable[, cutoff, x, y, scale])</p></td>
<td><p>Ignores stars close to the edge, i.e., within 100 * scale pixels by default.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#kai.reduce.prep_analysis.psfRadius" title="kai.reduce.prep_analysis.psfRadius"><code class="xref py py-obj docutils literal notranslate"><span class="pre">psfRadius</span></code></a>(starPeak, imagePeak[, scale])</p></td>
<td><p>Arbitrary function that ties the predicted radius of the star to the peak brightness in the image.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#kai.reduce.prep_analysis.isBrightSpeckleStar" title="kai.reduce.prep_analysis.isBrightSpeckleStar"><code class="xref py py-obj docutils literal notranslate"><span class="pre">isBrightSpeckleStar</span></code></a>(starPeak, imagePeak)</p></td>
<td><p>Can this star have halo speckles? If it's half the peak brightness, it is assumed yes.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#kai.reduce.prep_analysis.isNearBrightStar" title="kai.reduce.prep_analysis.isNearBrightStar"><code class="xref py py-obj docutils literal notranslate"><span class="pre">isNearBrightStar</span></code></a>(nearStarPeak, mainPeak)</p></td>
<td><p>Is the main star near another bright star?</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#kai.reduce.prep_analysis.isInPSFRadius" title="kai.reduce.prep_analysis.isInPSFRadius"><code class="xref py py-obj docutils literal notranslate"><span class="pre">isInPSFRadius</span></code></a>(starCoo, mainCoo, psfr)</p></td>
<td><p>Is star within the psf radius from earlier?</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#kai.reduce.prep_analysis.isInSecondaryRadius" title="kai.reduce.prep_analysis.isInSecondaryRadius"><code class="xref py py-obj docutils literal notranslate"><span class="pre">isInSecondaryRadius</span></code></a>(starCoo, mainCoo, psfr)</p></td>
<td><p>Is star within the secondary radius, defined as 1.35x the psf radius? (arbitrarily)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#kai.reduce.prep_analysis.getTableIndex" title="kai.reduce.prep_analysis.getTableIndex"><code class="xref py py-obj docutils literal notranslate"><span class="pre">getTableIndex</span></code></a>(mainIndex, starIndex)</p></td>
<td><p>Helper function to get star being considered in removeCloseStars.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#kai.reduce.prep_analysis.removeCloseStars" title="kai.reduce.prep_analysis.removeCloseStars"><code class="xref py py-obj docutils literal notranslate"><span class="pre">removeCloseStars</span></code></a>(imgArr, newTable[, pixelDist, x, y, ...])</p></td>
<td><p>In order of brightest stars in table, checks if it's a valid star, and tracks secondaries near it.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#kai.reduce.prep_analysis.getStats" title="kai.reduce.prep_analysis.getStats"><code class="xref py py-obj docutils literal notranslate"><span class="pre">getStats</span></code></a>(imgArr)</p></td>
<td><p>Returns mean median and mode of pixel values in image array.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#kai.reduce.prep_analysis.getNStarsHelper" title="kai.reduce.prep_analysis.getNStarsHelper"><code class="xref py py-obj docutils literal notranslate"><span class="pre">getNStarsHelper</span></code></a>(imgArr[, expStars, counter, ...])</p></td>
<td><p>Attempts to get N stars. If stars aren't found, returns what it can and presents the error.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#kai.reduce.prep_analysis.getNStars" title="kai.reduce.prep_analysis.getNStars"><code class="xref py py-obj docutils literal notranslate"><span class="pre">getNStars</span></code></a>(imgArr[, numStars, fwhm, scale])</p></td>
<td><p>Reformats table of chosen psf stars and adds the relevant secondaries to it.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#kai.reduce.prep_analysis.generate_list" title="kai.reduce.prep_analysis.generate_list"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_list</span></code></a>(imgPath[, numPSFStars, fwhm, scale, ...])</p></td>
<td><p>Plots the table generated by PSFListGen, and prints the list of stars in a format that can be used.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#kai.reduce.prep_analysis.plot_starlist_on_image_arcsec" title="kai.reduce.prep_analysis.plot_starlist_on_image_arcsec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_starlist_on_image_arcsec</span></code></a>(starList, imagePath, refCoo)</p></td>
<td><p>Plot a NIRC2 image and overlay a starlist. Input in relative arcsec coordinates.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#kai.reduce.prep_analysis.plot_starlist_on_image_pixel" title="kai.reduce.prep_analysis.plot_starlist_on_image_pixel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_starlist_on_image_pixel</span></code></a>(starList, imagePath, refStar)</p></td>
<td><p>Plot a NIRC2 image and overlay a starlist. Input in pixel coordinates.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#kai.reduce.prep_analysis.modded_plot_starlist_on_image_pixel" title="kai.reduce.prep_analysis.modded_plot_starlist_on_image_pixel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">modded_plot_starlist_on_image_pixel</span></code></a>(starList, ...[, ...])</p></td>
<td><p>Plot a NIRC2 image and overlay a starlist. Input in pixel coordinates.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#kai.reduce.prep_analysis.prepStarfinder" title="kai.reduce.prep_analysis.prepStarfinder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepStarfinder</span></code></a>(dirName, targetName, targetCoords, ...)</p></td>
<td><p>Creates a _psf.list file and saves it in the source_list/ directory.</p></td>
</tr>
</tbody>
</table>
<dl class="py function">
<dt class="sig sig-object py" id="kai.reduce.prep_analysis.euclidean">
<span class="sig-prename descclassname"><span class="pre">kai.reduce.prep_analysis.</span></span><span class="sig-name descname"><span class="pre">euclidean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/kai/reduce/prep_analysis.html#euclidean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kai.reduce.prep_analysis.euclidean" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kai.reduce.prep_analysis.removeEdges">
<span class="sig-prename descclassname"><span class="pre">kai.reduce.prep_analysis.</span></span><span class="sig-name descname"><span class="pre">removeEdges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finalTable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'xcentroid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ycentroid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.009942</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/kai/reduce/prep_analysis.html#removeEdges"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kai.reduce.prep_analysis.removeEdges" title="Link to this definition"></a></dt>
<dd><p>Ignores stars close to the edge, i.e., within 100 * scale pixels by default.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kai.reduce.prep_analysis.psfRadius">
<span class="sig-prename descclassname"><span class="pre">kai.reduce.prep_analysis.</span></span><span class="sig-name descname"><span class="pre">psfRadius</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">starPeak</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imagePeak</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.009942</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/kai/reduce/prep_analysis.html#psfRadius"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kai.reduce.prep_analysis.psfRadius" title="Link to this definition"></a></dt>
<dd><p>Arbitrary function that ties the predicted radius of the star to the peak brightness in the image.
returns a radius: 10 &lt; (Ratio of “magnitudes” cubed * 80) &lt; 60 and scaled acc. to plate scale in arcsec</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kai.reduce.prep_analysis.isBrightSpeckleStar">
<span class="sig-prename descclassname"><span class="pre">kai.reduce.prep_analysis.</span></span><span class="sig-name descname"><span class="pre">isBrightSpeckleStar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">starPeak</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imagePeak</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/kai/reduce/prep_analysis.html#isBrightSpeckleStar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kai.reduce.prep_analysis.isBrightSpeckleStar" title="Link to this definition"></a></dt>
<dd><p>Can this star have halo speckles? If it’s half the peak brightness, it is assumed yes.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kai.reduce.prep_analysis.isNearBrightStar">
<span class="sig-prename descclassname"><span class="pre">kai.reduce.prep_analysis.</span></span><span class="sig-name descname"><span class="pre">isNearBrightStar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nearStarPeak</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mainPeak</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/kai/reduce/prep_analysis.html#isNearBrightStar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kai.reduce.prep_analysis.isNearBrightStar" title="Link to this definition"></a></dt>
<dd><p>Is the main star near another bright star?</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kai.reduce.prep_analysis.isInPSFRadius">
<span class="sig-prename descclassname"><span class="pre">kai.reduce.prep_analysis.</span></span><span class="sig-name descname"><span class="pre">isInPSFRadius</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">starCoo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mainCoo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psfr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/kai/reduce/prep_analysis.html#isInPSFRadius"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kai.reduce.prep_analysis.isInPSFRadius" title="Link to this definition"></a></dt>
<dd><p>Is star within the psf radius from earlier?</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kai.reduce.prep_analysis.isInSecondaryRadius">
<span class="sig-prename descclassname"><span class="pre">kai.reduce.prep_analysis.</span></span><span class="sig-name descname"><span class="pre">isInSecondaryRadius</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">starCoo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mainCoo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psfr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/kai/reduce/prep_analysis.html#isInSecondaryRadius"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kai.reduce.prep_analysis.isInSecondaryRadius" title="Link to this definition"></a></dt>
<dd><p>Is star within the secondary radius, defined as 1.35x the psf radius? (arbitrarily)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kai.reduce.prep_analysis.getTableIndex">
<span class="sig-prename descclassname"><span class="pre">kai.reduce.prep_analysis.</span></span><span class="sig-name descname"><span class="pre">getTableIndex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mainIndex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starIndex</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/kai/reduce/prep_analysis.html#getTableIndex"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kai.reduce.prep_analysis.getTableIndex" title="Link to this definition"></a></dt>
<dd><p>Helper function to get star being considered in removeCloseStars.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kai.reduce.prep_analysis.removeCloseStars">
<span class="sig-prename descclassname"><span class="pre">kai.reduce.prep_analysis.</span></span><span class="sig-name descname"><span class="pre">removeCloseStars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newTable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixelDist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'xcentroid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ycentroid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.009942</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/kai/reduce/prep_analysis.html#removeCloseStars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kai.reduce.prep_analysis.removeCloseStars" title="Link to this definition"></a></dt>
<dd><p>In order of brightest stars in table, checks if it’s a valid star, and tracks secondaries near it.
Removes all invalid stars from table, i.e, those that are likely halo speckles, or too close for valid psf generation.
Edge stars are already removed from table using the removeEdges() method.</p>
<p>Terminology?
main - Star that is being considered for psf-ness.
star - Star that is being checked for nearness to main
psf radius - Radius (arbitrary function tied to brightness) that is checked for halo speckles/close bright stars
secondary radius - Radius in which, if star found, mark as secondary</p>
<p>Pseudocode:</p>
<p>Sort the table by brightest
imagePeak = brightest star peak value in image
invalidStarIndices = indices of stars to be removed from table</p>
<dl>
<dt>for each star in table, that is not marked invalid yet:</dt><dd><p>set this star to the main star
find the psf radius of this star</p>
<p>for all star-lookalikes less bright than main star:</p>
<blockquote>
<div><p>if star-lookalike is within psf radius (arbitrary function tied to brightness):</p>
<blockquote>
<div><p>if main star can have halo speckles (arbitrary brightness limit tied to imagePeak):</p>
<blockquote>
<div><dl class="simple">
<dt>if lookalike is too bright to be a halo speckle (arbitrary brightness limit tied to mainPeak):</dt><dd><p>add main star to invalidIndices (another bright star is too near it!)
add bright star to invalidIndices (too close to main star)</p>
</dd>
<dt>else lookalike is probably halo speckle:</dt><dd><p>add lookalike to invalidIndices (too close to main star, not actually a star)
keep the main star!!</p>
</dd>
</dl>
</div></blockquote>
<p>else main star cannot have halo speckles:</p>
<blockquote>
<div><dl class="simple">
<dt>if there is a BRIGHT star-lookalike nearby:</dt><dd><p>its definitely a star and not halo speckle AND star is too close!
add main star to invalidIndices (another bright star is too near it!)
add bright star to invalidIndices (too close to main star)</p>
</dd>
</dl>
</div></blockquote>
</div></blockquote>
<dl class="simple">
<dt>else if star-lookalike is within secondary radius (arbitrary function tied to brightness):</dt><dd><p>set the “psf?” value of this star in table to 0 (secondary)</p>
</dd>
</dl>
</div></blockquote>
</dd>
</dl>
<p>from the table, remove all the invalid stars!
return table</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kai.reduce.prep_analysis.getStats">
<span class="sig-prename descclassname"><span class="pre">kai.reduce.prep_analysis.</span></span><span class="sig-name descname"><span class="pre">getStats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgArr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/kai/reduce/prep_analysis.html#getStats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kai.reduce.prep_analysis.getStats" title="Link to this definition"></a></dt>
<dd><p>Returns mean median and mode of pixel values in image array.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kai.reduce.prep_analysis.getNStarsHelper">
<span class="sig-prename descclassname"><span class="pre">kai.reduce.prep_analysis.</span></span><span class="sig-name descname"><span class="pre">getNStarsHelper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expStars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">counter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starsFound</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.009942</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/kai/reduce/prep_analysis.html#getNStarsHelper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kai.reduce.prep_analysis.getNStarsHelper" title="Link to this definition"></a></dt>
<dd><p>Attempts to get N stars. If stars aren’t found, returns what it can and presents the error.
If so, starfinding may have to be done manually.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kai.reduce.prep_analysis.getNStars">
<span class="sig-prename descclassname"><span class="pre">kai.reduce.prep_analysis.</span></span><span class="sig-name descname"><span class="pre">getNStars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgArr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numStars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.009942</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/kai/reduce/prep_analysis.html#getNStars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kai.reduce.prep_analysis.getNStars" title="Link to this definition"></a></dt>
<dd><p>Reformats table of chosen psf stars and adds the relevant secondaries to it.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kai.reduce.prep_analysis.generate_list">
<span class="sig-prename descclassname"><span class="pre">kai.reduce.prep_analysis.</span></span><span class="sig-name descname"><span class="pre">generate_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">imgPath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numPSFStars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.009942</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/kai/reduce/prep_analysis.html#generate_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kai.reduce.prep_analysis.generate_list" title="Link to this definition"></a></dt>
<dd><p>Plots the table generated by PSFListGen, and prints the list of stars in a format that can be used.
&#64;params
imgPath - path to .fits image, Eg. /g/lu/data/microlens/18jun22/combo/mag18jun22_ob040361_kp.fits
numPSFStars - number of stars to be found
scale - defaults to nirc2 scale. Enter in arcsec/pixel.
targName - name of target (can be anything, not important)
fwhm - full-width half maximum variable for finicky images</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kai.reduce.prep_analysis.plot_starlist_on_image_arcsec">
<span class="sig-prename descclassname"><span class="pre">kai.reduce.prep_analysis.</span></span><span class="sig-name descname"><span class="pre">plot_starlist_on_image_arcsec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">starList</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imagePath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refCoo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9.942</span> <span class="pre">/</span> <span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magCut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">23</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/kai/reduce/prep_analysis.html#plot_starlist_on_image_arcsec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kai.reduce.prep_analysis.plot_starlist_on_image_arcsec" title="Link to this definition"></a></dt>
<dd><p>Plot a NIRC2 image and overlay a starlist. Input in relative arcsec coordinates.
&#64;params
starList - any astropy Table with a “name” (including target),</p>
<blockquote>
<div><p>“m”,
“x” (relative arcsec coordinates), and
“y” (relative arcsec coordinates) column.</p>
</div></blockquote>
<p>imagePath - path to image from root.
refCoo - reference pixel coordinates of a star in image file.
scale - plate scale. Defaults to NIRC2 plate scale.
magCut - highest magnitude of star allowed to be plotted.
label - if True, adds labels. Defaults to true.
verbose - if True, prints the astropy table inputted. Defaults to true.
flip - if True, flips image in x (helps in case image is backwards).</p>
<p>Ensure that the image passed in is at a Position Angle of 0.</p>
<p>The image is NOT Flipped on plotting by default.
In order to flip image, set flip = True.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kai.reduce.prep_analysis.plot_starlist_on_image_pixel">
<span class="sig-prename descclassname"><span class="pre">kai.reduce.prep_analysis.</span></span><span class="sig-name descname"><span class="pre">plot_starlist_on_image_pixel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">starList</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imagePath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refStar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9.942</span> <span class="pre">/</span> <span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magCut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">23</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pixel'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/kai/reduce/prep_analysis.html#plot_starlist_on_image_pixel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kai.reduce.prep_analysis.plot_starlist_on_image_pixel" title="Link to this definition"></a></dt>
<dd><p>Plot a NIRC2 image and overlay a starlist. Input in pixel coordinates.
&#64;params
starList - any astropy Table with a “name” (including target),</p>
<blockquote>
<div><p>“m”,
“x” (pixel coordinates), and
“y” (pixel coordinates) column.</p>
</div></blockquote>
<p>imagePath - path to image from root.
refStar - name of reference star in astropy table, generally the target.
scale - plate scale. Defaults to NIRC2 plate scale.
magCut - highest magnitude of star allowed to be plotted.
label - if True, adds labels. Defaults to true.
verbose - if True, prints the astropy table inputted. Defaults to true.
flip - if True, flips image in x (helps in case image is backwards).
axes - determines units on the axes of plot (pixel or arcsec). Defaults to pixel.</p>
<p>Ensure that the image passed in is at a Position Angle of 0.</p>
<p>The image is NOT Flipped on plotting by default.
In order to flip image, set flip = True.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kai.reduce.prep_analysis.modded_plot_starlist_on_image_pixel">
<span class="sig-prename descclassname"><span class="pre">kai.reduce.prep_analysis.</span></span><span class="sig-name descname"><span class="pre">modded_plot_starlist_on_image_pixel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">starList</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imagePath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refStar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9.942</span> <span class="pre">/</span> <span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magCut</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">23</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pixel'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/kai/reduce/prep_analysis.html#modded_plot_starlist_on_image_pixel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kai.reduce.prep_analysis.modded_plot_starlist_on_image_pixel" title="Link to this definition"></a></dt>
<dd><p>Plot a NIRC2 image and overlay a starlist. Input in pixel coordinates.
&#64;params
starList - any astropy Table with a “name” (including target),</p>
<blockquote>
<div><p>“m”,
“x” (pixel coordinates), and
“y” (pixel coordinates) column.</p>
</div></blockquote>
<p>imagePath - path to image from root.
refStar - name of reference star in astropy table, generally the target.
scale - plate scale. Defaults to NIRC2 plate scale.
magCut - highest magnitude of star allowed to be plotted.
label - if True, adds labels. Defaults to true.
verbose - if True, prints the astropy table inputted. Defaults to true.
flip - if True, flips image in x (helps in case image is backwards).
axes - determines units on the axes of plot (pixel or arcsec). Defaults to pixel.</p>
<p>Ensure that the image passed in is at a Position Angle of 0.</p>
<p>The image is NOT Flipped on plotting by default.
In order to flip image, set flip = True.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="kai.reduce.prep_analysis.prepStarfinder">
<span class="sig-prename descclassname"><span class="pre">kai.reduce.prep_analysis.</span></span><span class="sig-name descname"><span class="pre">prepStarfinder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirName</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targetName</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targetCoords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psfStars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filterName</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/kai/reduce/prep_analysis.html#prepStarfinder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#kai.reduce.prep_analysis.prepStarfinder" title="Link to this definition"></a></dt>
<dd><p>Creates a _psf.list file and saves it in the source_list/ directory.</p>
</dd></dl>

</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../lin_correction/index.html" class="btn btn-neutral float-left" title="kai.reduce.lin_correction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../reduce_template/index.html" class="btn btn-neutral float-right" title="kai.reduce.reduce_template" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, J. R. Lu, A. K. Gautam, T. Do.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>